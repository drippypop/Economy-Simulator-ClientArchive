(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{3889:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/My/Messages",function(){return n(6524)}])},2565:function(e,t,n){"use strict";var r=n(5893),a=(n(7294),n(4245)),s=n(7989),i=(0,a.QM)({image:{display:"block",margin:"0 auto",width:"100%",maxWidth:"728px",height:"auto"}});t.Z=function(e){i();return(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)(s.Z,{type:1})})})}},3781:function(e,t,n){"use strict";var r=n(5893),a=n(4245),s=(n(1796),(0,a.QM)({button:{color:"#777777",fontSize:"15px",border:"1px solid #777777",background:"linear-gradient(0deg, rgba(224,224,224,1) 0%, rgba(255,255,255,1) 100%)","&:hover":{background:"linear-gradient(0deg, rgba(203,216,255,1) 0%, rgba(255,255,255,1) 100%)"},margin:"0 auto",display:"block"},col:{paddingLeft:0,paddingRight:0}}));t.Z=function(e){var t=e.pageCount,n=e.page,a=s();return(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-12",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"".concat(a.col," col-3"),children:(0,r.jsx)("button",{className:a.button,onClick:e.onClick(-1),children:"\u25c4"})}),(0,r.jsx)("div",{className:"".concat(a.col," col-6"),children:(0,r.jsxs)("p",{className:"mb-0 pl-2 pr-2 text-center",children:["Page ",n," ","number"===typeof t&&" of "+t.toLocaleString()||""]})}),(0,r.jsx)("div",{className:"".concat(a.col," col-3"),children:(0,r.jsx)("button",{className:a.button,onClick:e.onClick(1),children:"\u25ba"})})]})})})}},3772:function(e,t,n){"use strict";var r=n(5893),a=(0,n(4245).QM)({header:{fontSize:"38px",marginBottom:0,fontWeight:400}});t.Z=function(e){var t=a();return(0,r.jsx)("h1",{className:t.header,children:e.children})}},2918:function(e,t,n){"use strict";var r=n(5893),a=n(7294),s=n(4245),i=(n(465),n(9125)),c=n(1747),o=(0,s.QM)({image:{maxWidth:"400px",width:"100%",margin:"0 auto",height:"auto",display:"block"}});t.Z=function(e){var t=o(),n=(e.size,(0,a.useState)(0)),s=n[0],l=n[1],u=c.Z.useContainer(),d=(0,a.useState)(e.url?e.url:u.getUserThumbnail(e.id,"420x420")),f=d[0],h=d[1];return(0,a.useEffect)((function(){e.url?h(e.url):(l(0),h(u.getUserThumbnail(e.id,"420x420")))}),[e]),(0,a.useEffect)((function(){e.url||h(u.getUserThumbnail(e.id,"420x420"))}),[u.thumbnails]),(0,r.jsx)("img",{className:t.image,src:f,alt:e.name,onError:function(e){s>=3||((0,i.a)({errorEvent:e,type:"playerHeadshot",src:f}),l(s+1),h("/img/placeholder.png"))}})}},6524:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=n(5893),a=n(7294),s=n(4245),i=n(8305),c=n(5967),o=(0,i.f)((function(){var e=(0,a.useState)(null),t=e[0],n=e[1],r=(0,a.useState)(null),s=r[0],i=r[1],o=(0,a.useState)(0),l=o[0],u=o[1],d=(0,a.useState)(null),f=d[0],h=d[1],m=(0,a.useState)(null),p=m[0],g=m[1],b=(0,a.useState)(null),x=b[0],v=b[1],j=(0,a.useState)([]),y=j[0],k=j[1];(0,a.useEffect)((function(){(0,c.qm)().then(n)}),[]);var N=function(e){i(null),h(null),(0,c._U)({tab:e,offset:l,limit:10}).then((function(e){i(e.collection),h(10*e.totalPages)}))};return(0,a.useEffect)((function(){console.debug("[info] use ms tab",x),k([]),i(null),"notifications"===x?(i(t.collection),h(t.collection.length)):"inbox"===x||"sent"===x||"archive"===x?N(x):i(null)}),[p,x,l]),{limit:10,offset:l,setOffset:u,total:f,setTotal:h,messages:s,setMessages:i,notifications:t,setNotifications:n,highlightedMessage:p,setHighlightedMessage:g,checked:y,setChecked:k,tab:x,setTab:v,getMessagesForTab:N}})),l=n(2565),u=n(1681),d=n(7484),f=n.n(d),h=n(5435),m=n(9979),p=n(7378),g=(n(3772),n(2918)),b=n(8452),x=(0,s.QM)({username:{fontWeight:700,marginBottom:0},created:{marginBottom:0,color:"#969696",fontWeight:500},subject:{fontWeight:400},subjectBodyParagraph:{marginBottom:0},body:{whiteSpace:"break-spaces"},backButtonWrapper:{width:"80px",float:"left"},replyButtonWrapper:{width:"110px",float:"left",marginLeft:"10px"},archiveButtonWrapper:{},replyText:{width:"100%",padding:"8px 10px",background:"#eaeaea",border:"1px solid #666"},replyWrapper:{width:"170px",float:"right"}}),v=function(e){var t=x(),n=(0,m.Z)(),s=o.useContainer(),i=(0,a.useState)(!1),l=i[0],u=i[1],d=(0,a.useRef)(null),v=1!==e.fromUserId,j=h.Z.useContainer(),y=(0,a.useState)(null),k=y[0],N=y[1];return(0,a.useEffect)((function(){1!==e.id&&!0!==e.read&&e.fromUserId!==j.userId&&(0,c.xr)({messageIds:[e.id],isRead:!0})}),[]),(0,a.useEffect)((function(){N(null)}),[e]),(0,r.jsxs)("div",{className:"row pt-2",children:[(0,r.jsxs)("div",{className:"col-12",children:[(0,r.jsx)("div",{className:t.backButtonWrapper,children:(0,r.jsx)(p.Z,{label:"Back",className:n.cancelButton,onClick:function(){s.setHighlightedMessage(null)}})}),v&&(0,r.jsx)("div",{className:t.replyButtonWrapper,children:(0,r.jsx)(p.Z,{label:"Reply",className:n.continueButton,onClick:function(){u(!l)}})})]}),(0,r.jsxs)("div",{className:"col-12",children:[(0,r.jsx)("h2",{className:t.subject,children:e.subject}),k?(0,r.jsx)("p",{className:"text-danger",children:k}):null]}),(0,r.jsx)("div",{className:"col-1 pe-0",children:(0,r.jsx)(g.Z,{id:e.fromUserId})}),(0,r.jsxs)("div",{className:"col-10",children:[(0,r.jsx)("p",{className:t.username,children:(0,r.jsx)(b.Z,{href:"/users/".concat(e.fromUserId,"/profile"),children:(0,r.jsx)("a",{className:"normal",children:e.fromUserName})})}),(0,r.jsx)("p",{className:t.created,children:f()(e.created).format("MMM DD, YYYY | h:mm A")})]}),(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)("p",{className:t.body+" mt-2",children:e.body})}),l&&(0,r.jsxs)("div",{className:"col-12",children:[(0,r.jsx)("textarea",{ref:d,maxLength:1e3,className:t.replyText,rows:8,placeholder:"Reply here..."}),(0,r.jsx)("div",{className:t.replyWrapper,children:(0,r.jsx)(p.Z,{label:"Send Reply",className:n.continueButton,onClick:function(){N(null),(0,c.bG)({userId:e.fromUserId,subject:"RE: "+e.subject,body:d.current.value,includePreviousMessage:!0,replyMessageId:e.id}).then((function(e){e.success?s.setHighlightedMessage(null):N(e.message||"Unknown error. Try again.")})).catch((function(e){N(e.message)}))}})})]})]})};function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=(0,s.QM)({username:{fontWeight:700,color:"#828282",marginBottom:0},subject:{fontWeight:700,color:"#828282"},subjectUnread:{color:"#000"},subjectBodyParagraph:{marginBottom:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},body:{color:"#969696",fontWeight:500},messageRow:{cursor:"pointer"},userImage:{maxWidth:"100%",display:"inline-block",position:"relative",marginTop:"-15px",paddingLeft:"15px"},markRead:{zIndex:99,cursor:"pointer"},markReadWrapper:{display:"inline-block",width:"10px",position:"relative",top:"20px",zIndex:99},userCheckAndImage:{display:"inline-block",width:"65px"},subjectAndContent:{display:"inline-block",width:"calc(100% - 65px)",verticalAlign:"super"}}),N=function(e){var t=k(),n=o.useContainer(),a=void 0!==n.checked.find((function(t){return t.id===e.id}));return(0,r.jsxs)("div",{className:"pt-2 ".concat(t.messageRow),onClick:function(t){t.preventDefault(),n.setHighlightedMessage(e)},children:[(0,r.jsxs)("div",{className:t.userCheckAndImage,children:[(0,r.jsx)("div",{className:t.markReadWrapper,children:(0,r.jsx)("input",{type:"checkbox",checked:a,className:t.markRead,onChange:function(){},onClick:function(t){t.stopPropagation(),a?n.setChecked(n.checked.filter((function(t){return t.id!==e.id}))):n.setChecked(y(n.checked).concat([e]))}})}),(0,r.jsx)("div",{className:t.userImage,children:(0,r.jsx)(g.Z,{id:e.fromUserId})})]}),(0,r.jsxs)("div",{className:t.subjectAndContent,children:[(0,r.jsx)("p",{className:t.username,children:e.fromUserName}),(0,r.jsxs)("p",{className:t.subjectBodyParagraph,children:[(0,r.jsx)("span",{className:t.subject+" "+(e.read?"":t.subjectUnread),children:e.subject})," - ",(0,r.jsx)("span",{className:t.body,children:e.body})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"divider-top"})})]})},w=n(3781),C=(0,s.QM)({buttonWrapper:{}}),S=function(e){C();var t=o.useContainer();if(null===t.messages)return null;var n=Math.ceil(t.total/t.limit),a=Math.ceil(t.offset/t.limit)+1;return(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-12 col-lg-4 offset-lg-8 mt-3 mb-2",children:(0,r.jsx)(w.Z,{page:a,pageCount:0===n?1:n,onClick:function(e){return function(r){r.preventDefault();var s=a+e;s>n||s<=0||t.setOffset(1===e?t.offset+t.limit:t.offset-t.limit)}}})})})};function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=(0,s.QM)({row:{border:"1px solid #c3c3c3"},buttonWrapper:{marginTop:"3px",float:"left"},button:{fontSize:"16px"},buttonMarkUnread:{width:"175px"},buttonArchive:{width:"100px"},buttonMarkRead:{width:"125px"}}),W=function(e){var t=A(),n=(0,m.Z)(),s=o.useContainer();(0,a.useEffect)((function(){s.tab!==e.tab&&(s.setOffset(0),s.setTotal(null),s.setTab(e.tab))}));var i="archive"===e.tab?"Unarchive":"Archive",l="sent"!==s.tab&&"notifications"!==s.tab,u="sent"===s.tab,d=function(e){return function(t){t.preventDefault(),(0,c.xr)({messageIds:s.checked.map((function(e){return e.id})),isRead:e}).then((function(){var t=s.messages.map((function(t){return s.checked.find((function(e){return e.id===t.id}))&&(t.isRead=e),t}));s.setMessages(t),s.setChecked([])}))}};return s.messages?(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-12 col-lg-6 mt-2",children:l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:t.buttonWrapper,children:(0,r.jsx)("input",{type:"checkbox",className:"mt-2 me-2",checked:s.messages&&0!==s.messages.length&&s.checked.length===s.messages.length||!1,onChange:function(e){if(!e.currentTarget.checked)return s.setChecked([]);var t=I(s.checked);s.messages.forEach((function(e){s.checked.find((function(t){return t.id===e.id}))||t.push({id:e.id,read:e.read,archived:"archive"===s.tab})})),s.setChecked(t)}})}),(0,r.jsx)("div",{className:t.buttonWrapper+" ms-1 "+t.buttonArchive,children:(0,r.jsx)(p.Z,{disabled:0===s.checked.length,label:i,className:n.continueButton+" "+t.button,onClick:function(e){(0,c.Lk)({messageIds:s.checked.map((function(e){return e.id})),isArchived:"Archive"===i}).then((function(){s.getMessagesForTab(s.tab),s.setChecked([])}))}})}),(0,r.jsx)("div",{className:t.buttonWrapper+" ms-1 "+t.buttonMarkRead,children:(0,r.jsx)(p.Z,{disabled:0===s.checked.length,label:"Mark as Read",className:n.continueButton+" "+t.button,onClick:d(!0)})}),(0,r.jsx)("div",{className:t.buttonWrapper+" ms-1 "+t.buttonMarkUnread,children:(0,r.jsx)(p.Z,{disabled:0===s.checked.length,label:"Mark as Unread",className:n.continueButton+" "+t.button,onClick:d(!1)})})]})}),(0,r.jsx)("div",{className:"col-12 col-lg-6",children:(0,r.jsx)(S,{})}),(0,r.jsx)("div",{className:"col-12 ".concat(t.row),children:s.messages.map((function(e){var t=u?e.recipient:e.sender;return t?(0,r.jsx)(N,{fromUserId:t.id,fromUserName:t.name,body:e.body,subject:e.subject,created:e.updated,read:!!u||e.isRead,archived:"archive"===s.tab,id:e.id},e.id):null}))})]}):null};function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){U(e,t,n[t])}))}return e}var E=(0,s.QM)({messagesContainer:{background:"#fff",padding:"4px 8px",overflow:"hidden",minHeight:"100vh"}}),B=function(e){var t=E(),n=o.useContainer(),s=(0,a.useState)("Inbox"),i=s[0],c=s[1];return(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:t.messagesContainer,children:(0,r.jsx)("div",{className:"row mt-2",children:(0,r.jsx)("div",{className:"col-12",children:n.highlightedMessage?(0,r.jsx)(v,Z({},n.highlightedMessage)):(0,r.jsx)(u.Z,{onChange:function(e){c(e.name)},default:i,options:[{name:"Inbox",element:(0,r.jsx)(W,{tab:"inbox"})},{name:"Sent",element:(0,r.jsx)(W,{tab:"sent"})},{name:"Notifications",element:(0,r.jsx)(W,{tab:"notifications"}),count:n.notifications?n.notifications.collection.length:void 0},{name:"Archive",element:(0,r.jsx)(W,{tab:"archive"})}]})})})})]})},T=function(e){return(0,r.jsx)(o.Provider,{children:(0,r.jsx)(B,{})})}},1796:function(e,t,n){"use strict";var r=n(7294),a=n(8305),s=n(2300),i=n(5304),c=n(387),o=function(e){switch(e.toLowerCase().trim()){case"collectible":case"collectibles":return 2;case"featured":return 0;case"accessories":return 11;case"clothing":return 3;case"gears":case"gear":return 5;case"bodyparts":return 4}throw new Error('Invalid category "'+e+'"')},l=function(e){switch(e.toLowerCase().trim()){case"items":case"hats":case"all":case"gear":return 0;case"face":case"faces":return 10;case"packages":return 37;case"shirts":return 12;case"tshirts":return 13;case"pants":return 14;case"building":return 8;case"explosive":return 3;case"melee":return 1;case"musical":return 6;case"navigation":return 5;case"powerup":return 4;case"ranged":return 2;case"social":return 7;case"transport":return 9}throw new Error('Invalid subcategory "'+e+'"')},u=(0,a.f)((function(){var e=(0,c.useRouter)(),t=(0,r.useState)(e.query.keyword||""),n=t[0],a=t[1],u=(0,r.useState)(1),d=u[0],f=u[1],h=(0,r.useState)((0,s.Z)("catalogPageLimit",28)),m=h[0],p=h[1],g=(0,r.useState)("Featured"),b=g[0],x=g[1],v=(0,r.useState)(""),j=v[0],y=v[1],k=(0,r.useState)(!1),N=k[0],w=k[1],C=(0,r.useState)(null),S=C[0],M=C[1],I=(0,r.useState)(null),A=I[0],W=I[1],U=(0,r.useState)(null),Z=U[0],E=U[1],B=(0,r.useState)(null),T=B[0],R=B[1],O=(0,r.useState)(null),P=O[0],_=O[1],L=(0,r.useState)(0),Q=L[0],z=L[1],D=(0,r.useState)([]),H=D[0],q=D[1];(0,r.useEffect)((function(){w(!0);var e=null;(0,i._w)({category:b,subCategory:j,query:n,limit:m,cursor:P,sort:Q}).then((function(t){return 0===(e=t).data.length?[]:(0,i.rV)(t.data.map((function(e){return e.id})))})).then((function(t){var n=[],r=!0,a=!1,s=void 0;try{for(var i,c=function(e,r){var a=r.value,s=t.data.data.find((function(e){return e.id===a.id}));s&&n.push(s)},o=e.data[Symbol.iterator]();!(r=(i=o.next()).done);r=!0)c(0,i)}catch(u){a=!0,s=u}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}e.data=n,M(e),E(e.nextPageCursor),R(e.previousPageCursor);var l=e._total;W("number"===typeof l?l:null)})).finally((function(){w(!1)}))}),[P,Q,b,j,H,n,m]);var F=function(){_(null),f(1)};return{locked:N,results:S,total:A,nextCursor:Z,previousCursor:T,setCursor:_,sort:Q,setSort:z,category:b,setCategory:function(e){F(),x(e)},stringToCategory:o,subCategory:j,setSubCategory:function(e){F(),y(e)},stringToSubCategory:l,genres:H,setGenres:function(e){F(),q(e)},query:n,setQuery:function(e){F(),a(e)},limit:m,setLimit:function(e){F(),p(e)},page:d,setPage:f}}));t.Z=u}},function(e){e.O(0,[790,774,888,179],(function(){return t=3889,e(e.s=t);var t}));var t=e.O();_N_E=t}]);